// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Product {
  id           Int      @id @default(autoincrement())
  name         String
  price        Int
  actual_price Int? @default(0)
  discount     Int?
  is_populer   Boolean  @default(false)
  total_diamond Int
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt
  transactions Transaction[]

  @@map("products")
}

model Transaction {
  id                      Int               @id @default(autoincrement())
  merchant_transaction_id String            @unique @db.VarChar(64)
  target_id               Int?
  total_diamond           Int
  total_amount            Int
  price                   Int? @default(0)
  actual_price            Int? @default(0)
  status                  TransactionStatus @default(pending)
  no_wa                   String
  product_id              Int?
  product                 Product?          @relation(fields: [product_id], references: [id])
  created_at              DateTime          @default(now())
  updated_at              DateTime          @updatedAt

  @@map("transactions")
}

model User {
  id         Int      @id @default(autoincrement())
  username   String   @unique
  password   String
  name       String
  role       UserRole @default(admin)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  @@map("users")
}

enum TransactionStatus {
  pending
  processing
  success
  failed
}

enum UserRole {
  admin
  user
}
